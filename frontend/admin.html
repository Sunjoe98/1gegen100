<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <title>1 gegen 100 â€“ Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Admin</h1>

    <div class="card">
      <div class="row">
        <span id="regStatus" class="badge">Registrierung: OFFEN</span>
        <span class="badge">Im Spiel: <span id="aliveCount">0</span>/<span id="totalCount">0</span></span>
      </div>
      <div class="row" style="margin-top:10px;">
        <button id="startBtn" class="btn">Registrierung schlieÃŸen (Start)</button>
        <button id="openBtn"  class="btn secondary">Registrierung Ã¶ffnen</button>
      </div>
      <div class="row">
        <button id="nextBtn" class="btn">NÃ¤chste Frage</button>
        <button id="endBtn"  class="btn secondary">Frage beenden</button>
      </div>
    </div>

    <div class="card" style="margin-top:12px;">
      <h2>Aktuelle Frage</h2>
      <div id="qText" class="footer">â€“</div>
      <div id="players" class="player-list"></div>
    </div>
  </div>

  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"></script>
  <script>
    const SOCKET_URL = 'https://onegegen100-u6h7.onrender.com';
    const socket = io(SOCKET_URL);

    document.getElementById('startBtn').onclick = () => socket.emit('startGame');
    document.getElementById('openBtn').onclick  = () => socket.emit('openRegistration');
    document.getElementById('nextBtn').onclick  = () => socket.emit('nextQuestion');
    document.getElementById('endBtn').onclick   = () => socket.emit('endQuestion');

    socket.on('registrationClosed', () => document.getElementById('regStatus').textContent = 'Registrierung: GESCHLOSSEN');
    socket.on('registrationOpened', () => document.getElementById('regStatus').textContent = 'Registrierung: OFFEN');

    socket.on('stats', ({alive,total}) => {
      document.getElementById('aliveCount').innerText = alive;
      document.getElementById('totalCount').innerText = total;
    });

    socket.on('displayQuestion', (q) => {
      document.getElementById('qText').textContent = q.text + ' [' + q.answers.join(' / ') + ']';
    });

    socket.on('updatePlayers', (players) => {
      document.getElementById('players').innerHTML = players
        .map(p => `${p.alive ? 'ğŸŸ¢' : 'ğŸ”´'} #${p.number}${p.lastAnswer ? ' Â· ' + p.lastAnswer : ''}`)
        .join('<br>');
    });

    socket.on('noQuestionsLeft', () => alert('Keine Fragen mehr verfÃ¼gbar.'));
  </script>
</body>
</html>
